(()=>{"use strict";var e={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".button_action_submit",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},t={editProfilePopup:document.querySelector(".popup_type_edit"),openEditProfilePopupBtn:document.querySelector(".button_action_edit"),closeEditProfilePopupBtn:document.querySelector(".button_action_edit-popup-close"),editProfileForm:document.forms.edit,nameInput:document.querySelector(".form__input_type_name"),activityInput:document.querySelector(".form__input_type_activity"),profileName:document.querySelector(".profile__name"),profileActivity:document.querySelector(".profile__activity")},n={addCardPopup:document.querySelector(".popup_type_add-card"),openAddCardPopupBtn:document.querySelector(".button_action_add-card"),closeAddCardPopupBtn:document.querySelector(".button_action_add-popup-close"),addCardForm:document.forms.add,titleInput:document.querySelector(".form__input_type_title"),linkInput:document.querySelector(".form__input_type_link")},r={imagePopup:document.querySelector(".popup_type_image"),imagePopupImage:document.querySelector(".popup__image"),imagePopupCaption:document.querySelector(".popup__caption"),closeImagePopupBtn:document.querySelector(".button_action_img-popup-close")};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t.name,this._link=t.link,this._handleCardClick=n,this._cardSelector=r}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}},{key:"_handleDeleteCard",value:function(){this._element.remove(),this._element=null}},{key:"_handleLikeCard",value:function(){this._likeCardButton.classList.toggle("card__like-button_active")}},{key:"_setEventListeners",value:function(){var e=this;this._deleteCardButton=this._element.querySelector(".button_action_delete"),this._likeCardButton=this._element.querySelector(".button_action_like"),this._cardImage=this._element.querySelector(".card__image"),this._deleteCardButton.addEventListener("click",(function(){return e._handleDeleteCard()})),this._likeCardButton.addEventListener("click",(function(){return e._handleLikeCard()})),this._cardImage.addEventListener("click",(function(){return e._handleCardClick(e._link,e._name)}))}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._cardTitle=this._element.querySelector(".card__title"),this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardTitle.textContent=this._name,this._element}}])&&o(t.prototype,n),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),n.textContent=t,n.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._inactiveButtonClass)):(this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._inactiveButtonClass))}},{key:"_setEventListeners",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e.toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"removeInputErrors",value:function(){var e=this;this._inputList.forEach((function(t){t.validity.valid||e._hideInputError(t)}))}}])&&a(t.prototype,n),e}(),s=new u(e,t.editProfileForm);s.enableValidation();var l=new u(e,n.addCardForm);function c(e){e.classList.add("popup_opened"),document.addEventListener("click",m),document.addEventListener("keydown",p)}function d(e,t){r.imagePopupImage.src=e,r.imagePopupImage.alt=t,r.imagePopupCaption.textContent=t,c(r.imagePopup)}function p(e){"Escape"===e.key&&_(document.querySelector(".popup_opened"))}function m(e){e.target.classList.contains("popup")&&_(document.querySelector(".popup_opened"))}function _(e){e.classList.remove("popup_opened"),document.removeEventListener("click",m),document.removeEventListener("keydown",p)}function f(e){var t=new i(e,d,".card-template").generateCard();document.querySelector(".cards").prepend(t)}l.enableValidation(),[{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"}].forEach((function(e){f(e)})),t.openEditProfilePopupBtn.addEventListener("click",(function(){s.removeInputErrors(),t.nameInput.value=t.profileName.textContent,t.activityInput.value=t.profileActivity.textContent,c(t.editProfilePopup)})),t.closeEditProfilePopupBtn.addEventListener("click",(function(){return _(t.editProfilePopup)})),t.editProfileForm.addEventListener("submit",(function(e){e.preventDefault(),t.profileName.textContent=t.nameInput.value,t.profileActivity.textContent=t.activityInput.value,_(t.editProfilePopup)})),n.openAddCardPopupBtn.addEventListener("click",(function(){l.toggleButtonState(),l.removeInputErrors(),n.addCardForm.reset(),c(n.addCardPopup)})),n.closeAddCardPopupBtn.addEventListener("click",(function(){return _(n.addCardPopup)})),n.addCardForm.addEventListener("submit",(function(e){e.preventDefault(),f({name:n.titleInput.value,link:n.linkInput.value}),n.addCardForm.reset(),_(n.addCardPopup)})),r.closeImagePopupBtn.addEventListener("click",(function(){return _(r.imagePopup)}))})();